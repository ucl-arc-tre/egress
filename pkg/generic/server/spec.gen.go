// Package server provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.5.1 DO NOT EDIT.
package server

import (
	"bytes"
	"compress/gzip"
	"encoding/base64"
	"fmt"
	"net/url"
	"path"
	"strings"

	"github.com/getkin/kin-openapi/openapi3"
)

// Base64 encoded, gzipped, json marshaled Swagger object
var swaggerSpec = []string{

	"H4sIAAAAAAAC/7xYa2/bOBb9KxfcBdoC8iNOpjvr+dTpNt1gk0GQuLML1MXgWryy2UqkQlJO1cD/fXFJ",
	"SbZjJWn20W+2RPK+zznUnUhNURpN2jsxvRMlWizIkw3/zrIL9Onq3QyXl/yCn0lyqVWlV0aLqXj3taTU",
	"kwReA5mx4FcEmcoJXt5UxpN8BeigJAtXp2//MjmeDOGKfGU1L5zrsNLovAaVgfIunlOwVXLhLKMJXEmp",
	"yhRJULxPOVgRSrK/zLXxK7K3ylECNp6LcHI0gUtLqdFSsZ9wiionCWStsXMtEkFfsShzElMxF/IEfx4O",
	"hzTJXs+FSITiuOL5IhEaC152lg1CKkQiLN1UypIUU28rSoRLV1Qgp8bXJa913iq9FJtNIv5B9QOJ+6DV",
	"TUXwhWpQkrRXWa30cps9bzgeq2hNQ7jAGlKjPSrNOb5FK+fa5ehCknhlacmR9lCiX4GjZcEFvRdqac1n",
	"Sv3gaHI8oqUl50YSPQ5Tt27DvqnI1tuov1D9aMCF0uekl34lpkdJT/iXljL19YEMnCvnQ6wOblfGxVws",
	"aKm0g1vlV7HQa8wreiKMB7wvg3XxWIU2HJ0rjXYUGv5XlFd0U5Hz/I9TTjr8xLLMVYrs+uizY//vdo79",
	"s6VMTMWfRtthGsW3bvSOm+6qMRJN7ufhV5Rgo9FfQOk15koC2mUVaig2iTjTnqzG/Jrsmmw48Me590FT",
	"O+Oq8QNccCTOEzv4m/GnptLyx3nVVIlknBZpyIE2Huircl7E1uvmP47/j3NuD3uyaJxXNQfw+ftnMPBa",
	"U5L1KvZhQc7hkg6H5m/tvzXF9EO7dHdEzpou6tAcXnyh2r0QfUO6He+Pnd1P3UKz4GHjjJ6qnC7II2PG",
	"ocfkcdlDD9/LCk9g8j2vk4BMD2Eq22EIGAUwNFln/BloeGAwR+f/KIwMNHRoeqYKch6LEm5XpGOot+iA",
	"t0G7bQjXK1PlEjKT5+Y2MqDzqCVafmgL9K2/5+j84KLZCH+fzS4bzrsH6v8kmcDRz3BKC5iMJ6/h6PV0",
	"fDIdj+H9xUwkIp4qpkKip4FXBfVF59S3nma7Vt9oN3/Mvovak9v14HhyMh7v2FHavz4RCXODKqpCTMed",
	"PcaPJdmDros0E3y4n+gkNlZfPzJ/cE+6h8eInf4jNVWc+P3gfquKBVkOL3JQUBYEOePH494n4Vz3AKN1",
	"B1pyVe6Z1DNrinB4A/PMV54K9xTQ7E3cpnMErcWa/zcEd+DH78yZbeFexFUvIhhAac1aSZItxXZOsZYq",
	"lGdIDS0ct4GKuNpuC933OIbE5BxWjNuM0soqX19zgA3S+dztMHNR+Qrz2fl1xFWlM3MY3xsI5cEc3lye",
	"BXhBWJImq9LYp84bi0sKPKVSShr3uRahRqglvCc/19wsgQIcGGY01IB2obxFW3enLDD9QloOYbaiYFGS",
	"U0vNqSmMV2v0nJdFHbJ5fcxLElhUHlJkIc0Crc2zshRYvS3OuwA8rZ/DuZ7rN5VfsR6M1DSFi5ARmJ1f",
	"w8tidn79iv1Qrj3OwcI0hUxzxRKQg4sEPdfeQKsMIyP8a/jT+K+Q8ohkbIIccCwkYVEDgrdVINW3b4bw",
	"O28IToDJ5npvD1rmXE2APpj2FrUrjfWQY002pMpSZiwl4f0O2c51WAK3Ks9BE2fdUkpMaKih0riNnzph",
	"lADlqlAafSuSNXHSufYn4yP4ELYZq76FPREPhrFZlQ9AWaX5AG068JYGEe8HTc8MmkKLRKzJuthj4+HR",
	"cMxDZkrSWCoxFcfhUSKYVkLPjgKpTO/EknoA5j15aPSG20fRqPdVTDo/Xqo1aYgw2LXkmYyHnEbm2r2Z",
	"fezHje2SUXfx2CRPrj245W0+3ZPFk/H4EfVkUk9+4LylKPO3KqojhYXSGKR5jwDfz9rbnYzZPZEnkuZW",
	"Flxq1g3a+8eT3PVSDWnY9QYsjKxf7RLaw7ec51Jb69osvLrv2AVJhcDbWqpou2TvpiIpwypnqw+mug+I",
	"uYj/Pxn2nKvvnoD5bwXTghp+3tFLnaBplVMMsPs4EKb/+z1mn09in/fNSzcPo507Ythy8vSW7n7EG44m",
	"T2/oub1sEvHT97jXd1kM3FsVBc9gBKYwUPx41GmZXhC7ar5BAAZltFU33ZXdxTv7Vk90CiMqiGSujYWd",
	"zzSY563kykCbHaERYDCUrRcE3bNRcPf7wzNB7XlXwkMt2gNt+/IwfONq2SwSQKPn/rNG/B81x/arTAyh",
	"lWwh3VGsffzEuYwSI5ahsrmYitF6LDafNv8OAAD//5X2Sz9TFAAA",
}

// GetSwagger returns the content of the embedded swagger specification file
// or error if failed to decode
func decodeSpec() ([]byte, error) {
	zipped, err := base64.StdEncoding.DecodeString(strings.Join(swaggerSpec, ""))
	if err != nil {
		return nil, fmt.Errorf("error base64 decoding spec: %w", err)
	}
	zr, err := gzip.NewReader(bytes.NewReader(zipped))
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}
	var buf bytes.Buffer
	_, err = buf.ReadFrom(zr)
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}

	return buf.Bytes(), nil
}

var rawSpec = decodeSpecCached()

// a naive cached of a decoded swagger spec
func decodeSpecCached() func() ([]byte, error) {
	data, err := decodeSpec()
	return func() ([]byte, error) {
		return data, err
	}
}

// Constructs a synthetic filesystem for resolving external references when loading openapi specifications.
func PathToRawSpec(pathToFile string) map[string]func() ([]byte, error) {
	res := make(map[string]func() ([]byte, error))
	if len(pathToFile) > 0 {
		res[pathToFile] = rawSpec
	}

	return res
}

// GetSwagger returns the Swagger specification corresponding to the generated code
// in this file. The external references of Swagger specification are resolved.
// The logic of resolving external references is tightly connected to "import-mapping" feature.
// Externally referenced files must be embedded in the corresponding golang packages.
// Urls can be supported but this task was out of the scope.
func GetSwagger() (swagger *openapi3.T, err error) {
	resolvePath := PathToRawSpec("")

	loader := openapi3.NewLoader()
	loader.IsExternalRefsAllowed = true
	loader.ReadFromURIFunc = func(loader *openapi3.Loader, url *url.URL) ([]byte, error) {
		pathToFile := url.String()
		pathToFile = path.Clean(pathToFile)
		getSpec, ok := resolvePath[pathToFile]
		if !ok {
			err1 := fmt.Errorf("path not found: %s", pathToFile)
			return nil, err1
		}
		return getSpec()
	}
	var specData []byte
	specData, err = rawSpec()
	if err != nil {
		return
	}
	swagger, err = loader.LoadFromData(specData)
	if err != nil {
		return
	}
	return
}
